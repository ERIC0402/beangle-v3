/*
 * easyValidate, a form validation jquery plugin
 * By Alex Gill, www.apgdesign.co.uk
 * Version 1.0.1
 * Copyright 2011 APGDESIGN
 * Updated 30/12/2011
 * Free to use under the MIT License
 * http://www.opensource.org/licenses/mit-license.php
*/
(function($){$.fn.easyValidate=function(settings){var config={promptPosition:'topRight',ajaxSubmit:false,ajaxSubmitFile:""};var settings=$.extend(config,settings);return this.each(function(){var promptText="";var isError=false;var button;var form=$(this).find('form');if(settings.ajaxSubmit){_buildAjaxPrompts();var ajaxError=$('.ajaxError');var ajaxSuccess=$('.ajaxSuccess');var ajaxLoading=$('.ajaxLoading')}var elements=$(this).find('input, textarea, radio, checkbox');elements.each(function(){if($(this).attr('type')=='submit'){button=$(this)}});button.click(function(e){elements.each(function(){var elementTagName=this.tagName;var elementType=$(this).attr('type');if(elementTagName=='INPUT'&&elementType=='text'||elementTagName=='TEXTAREA'){_getRules($(this))}});if(_isValid()){_formSubmit()}e.preventDefault()});elements.each(function(){$(this).blur(function(){_getRules($(this))})});function _getRules(element){var rulesParsed=element.attr('class');if(rulesParsed){var rules=rulesParsed.split(' ');_validate(element,rules)}};function _validate(element,rules){promptText="";isError=false;for(var i=0;i<rules.length;i++){if(rules[i]=='required'){_required(element)}if(rules[i]=='email'){_email(element)}}if(isError){_buildPrompt(element,promptText)}else{_removePrompt(element)}};function _required(element){if(!element.val()){isError=true;promptText=promptText+'This field is required <br />'}};function _email(element){var filter=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;if(!filter.test(element.val())){isError=true;promptText=promptText+'Please provide a valid email address'}};function _isValid(){if(isError){return false}else{return true}};function _buildPrompt(element,prompText){_removePrompt(element);var divFormError=$('<div></div>');$(divFormError).addClass('formError');$(divFormError).addClass('formError'+$(element).attr('name'));$('body').append(divFormError);var formErrorContent=$('<div></div>');$(formErrorContent).addClass('formErrorContent');$(divFormError).append(formErrorContent);$(formErrorContent).html(promptText);var formErrorArrow=$('<div></div>');$(formErrorArrow).html('<div class="line10"><!-- --></div><div class="line9"><!-- --></div><div class="line8"><!-- --></div><div class="line7"><!-- --></div><div class="line6"><!-- --></div><div class="line5"><!-- --></div><div class="line4"><!-- --></div><div class="line3"><!-- --></div><div class="line2"><!-- --></div><div class="line1"><!-- --></div>');$(formErrorArrow).addClass('formErrorArrow');$(divFormError).append(formErrorArrow);var fieldWidth=element.width();var fieldHeight=element.height();var fieldTopPosition=element.offset().top;var fieldLeftPosition=element.offset().left;if(settings.promptPosition=='topRight'){fieldTopPosition=fieldTopPosition-divFormError.height();fieldLeftPosition=fieldLeftPosition+fieldWidth-30}if(settings.promptPosition=='topLeft'){fieldTopPosition=fieldTopPosition-divFormError.height();fieldLeftPosition=fieldLeftPosition}$(divFormError).css({position:'absolute',top:fieldTopPosition,left:fieldLeftPosition,opacity:0});return $(divFormError).animate({opacity:0.8})};function _removePrompt(element){$('body').find('.formError'+$(element).attr('name')).remove()};function _formSubmit(){if(settings.ajaxSubmit){ajaxLoading.ajaxStart(function(){$(this).show()});ajaxLoading.ajaxStop(function(){$(this).hide()});$.ajax({type:'POST',url:settings.ajaxSubmitFile,async:true,data:form.serialize(),success:function(data){ajaxSuccess.html(data).show('medium');form.hide()},error:function(xhr){ajaxError.html('Status: '+xhr.status).show('medium')}})}else{form.submit()}};function _buildAjaxPrompts(){var ajaxErrorDiv=$('<div></div>');ajaxErrorDiv.addClass('ajaxError');form.after(ajaxErrorDiv);_centerPrompt(ajaxErrorDiv);var ajaxSuccessDiv=$('<div></div>');ajaxSuccessDiv.addClass('ajaxSuccess');form.after(ajaxSuccessDiv);_centerPrompt(ajaxSuccessDiv);var ajaxLoadingDiv=$('<div></div>');ajaxLoadingDiv.addClass('ajaxLoading');form.after(ajaxLoadingDiv);_centerPrompt(ajaxLoadingDiv)};function _centerPrompt(notification){var windowWidth=$(window).width();var windowHeight=$(window).height();var scrollTop=$('body').scrollTop();var notificationWidth=notification.outerWidth();var notificationHeight=notification.outerHeight();var positionTop;if(scrollTop>0){positionTop=scrollTop}else{positionTop=(windowHeight-notificationHeight)/2}notification.css({"position":"absolute","top":positionTop,"right":(windowWidth-notificationWidth)/2})}})}})(jQuery);