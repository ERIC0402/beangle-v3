(function(h){function f(a,b,c,d,e){this.formid="form_"+bg.randomInt();this.actionurl=a;this.target=b;this.paramMap={};this.params=function(){return this.paramMap};this.pageInfo=function(a,b,c){this.pageNo=a;this.pageSize=b;this.total=c;null!=c&&null!=b&&null!=a?(quotient=Math.floor(c/b),this.maxPageNo=0==c%b?quotient:quotient+1,this.startNo=(a-1)*b+1,this.endNo=this.startNo+b-1<=c?this.startNo+b-1:c):this.maxPageNo=1};this.pageInfo(c,d,e);this.action=function(a){this.actionurl=a;return this};this.orderBy=
function(a){this.orderby=a;return this};this.target=function(a,b){if(a)this.target=a;else if(b)this.target=bg.findTarget(document.getElementById(b));return this};this.getForm=function(){myForm=document.getElementById(this.formid);null==myForm&&(myForm=document.createElement("form"),myForm.setAttribute("id",this.formid),myForm.setAttribute("action",this.actionurl),myForm.setAttribute("method","POST"),document.getElementById(this.target)?document.getElementById(this.target).appendChild(myForm):document.body.appendChild(myForm));
return myForm};this.addParams=function(a){bg.assert.notNull(a,"paramSeq for addHiddens must not be null");this.paramstr=a;var a=a.split("&"),b,c,d;for(b=0;b<a.length;b++)oneParam=a[b],oneParam!=""&&(c=oneParam.substr(0,oneParam.indexOf("=")),d=oneParam.substr(oneParam.indexOf("=")+1),this.paramMap[c]=d);return this};this.checkPageParams=function(a,b,c){if(null!=a){if(isNaN(a))return bg.alert("\u8f93\u5165\u5206\u9875\u7684\u9875\u7801\u662f:"+a+",\u5b83\u4e0d\u662f\u4e2a\u6574\u6570"),!1;if(this.maxPageNo!=
null&&a>this.maxPageNo)a=this.maxPageNo;this.paramMap.pageNo=a}if(null!=b){if(isNaN(b))return bg.alert("\u8f93\u5165\u5206\u9875\u7684\u9875\u957f\u662f:"+b+",\u5b83\u4e0d\u662f\u4e2a\u6574\u6570"),!1;this.paramMap.pageSize=b}null!=c&&c!="null"&&(this.paramMap.orderBy=c);return!0};this.goPageNormal=function(){var a=document.createElement("form"),b,c;a.setAttribute("action",this.actionurl);a.setAttribute("method","POST");for(b in this.paramMap)c=this.paramMap[b],c!=""&&bg.form.addInput(a,b,c,"hidden");
document.body.appendChild(a);a.submit()};this.goPageAjax=function(){var a=this.getForm(),b,c;for(b in this.paramMap)c=this.paramMap[b],c!=""&&bg.form.addInput(a,b,c,"hidden");b=this.formid+"_submitx";c=document.getElementById(b);if(null==c)c=document.createElement("button"),c.setAttribute("id",b),c.setAttribute("type","submit"),c.style.display="none",a.appendChild(c);a={jqueryaction:"button"};a.id=b;a.targets=this.target;a.href=this.actionurl;a.formids=this.formid;jQuery.struts2_jquery.bind(jQuery("#"+
b),a);c.click()};this.goPage=function(a,b,c){this.checkPageParams(a,b,c)&&(this.target&&document.getElementById(this.target)?this.goPageAjax(a,b,c):this.goPageNormal(a,b,c))}}if(!g){var g=function(){return!0};g.extend=function(a){for(attr in a){var b=attr.split("."),c=g,d;for(d=0;d<b.length-1;d++)c[b[d]]=c[b[d]]||{},c=c[b[d]];c[b[b.length-1]]=a[attr]}};h.beangle=g;h.bg=g;g.extend({Go:function(a,b,c){var d=a;if(typeof a=="object"&&a.tagName.toLowerCase()=="a")d=a.href,b||(b=bg.findTarget(a));b||(b=
"_self");if("_self"==b)self.location=d;else if("_parent"==b)self.parent.location=d;else if("_top"==b)self.top.location=d;else if("_new"==b||"_blank"==b)windown.open(d);else if(bg.isAjaxTarget(b))c?g.history.historyGo(d,b):jQuery("#"+b).load(d);else if(document.getElementById(b))document.getElementById(b).src=d;return!1},getContextPath:function(){return self.location.pathname.substring(0,self.location.pathname.substring(1).indexOf("/")+1)},ready:function(a){h.addEventListener?h.addEventListener("load",
a,!1):h.attachEvent?h.attachEvent("onload",a):h.onload=a},isAjaxTarget:function(a){if(!a)return!1;if(a==""||a=="_new"||a=="_blank"||a=="_self"||a=="_parent"||a=="_top")return!1;targetEle=document.getElementById(a);if(!targetEle)return!1;tagName=targetEle.tagName.toLowerCase();return tagName=="iframe"||tagName=="object"?!1:!0},normalTarget:function(a){if(a==""||a=="new"||a=="_blank"||a=="_self"||a=="_parent")return a;var b=document.getElementById(a);return!b||b.tagName.toLowerCase()!="iframe"?"_self":
a},findTarget:function(a){if(!a)return"_self";for(var b=a.parentNode,c="_self";b;)if(b.id&&b.className&&b.className.indexOf("_ajax_target")>-1){c=b.id;break}else b=b==b.parentNode?null:b.parentNode;return a.target=c}});g.extend({assert:{notNull:function(a,b){null==a&&alert(b)}}});bg.extend({randomInt:function(){var a=Math.random()*1E7;a-=a%1;return a}});g.extend({logger:{level:1,debug:function(a){if(g.logger.level<=0){var b="[beangle] "+a;h.console&&h.console.log?h.console.log(a):h.opera&&h.opera.postError?
h.opera.postError(b):alert(b)}}}});g.extend({event:{portable:function(a){return a?a:h.event},getTarget:function(a){a=bg.event.portable(a);return a.target||a.srcElement}}});g.extend({input:{toggleCheckBox:function(a,b){bg.input.boxAction(a,"toggle",b)},getRadioValue:function(a){return bg.input.boxAction(document.getElementsByName(a),"value")},getCheckBoxValues:function(a){a=bg.input.boxAction(document.getElementsByName(a),"value");return a==null?"":a},boxAction:function(a,b,c){var d="",e,f;if(a)if(a[0])for(f=
0;f<a.length;f++)if(b=="selected"){if(a[f].checked)return a[f].checked}else if(b=="value"){if(a[f].checked)a[f].type=="radio"?d=a[f].value:a[f].type=="checkbox"&&(d!=""&&(d+=","),d+=a[f].value)}else{if(b=="toggle"&&(e=g.event.getTarget(c),a[f].checked=e.checked,typeof a[f].onchange=="function"))a[f].onchange()}else if(b=="selected")return a.checked;else if(b=="value"){if(a.checked)d=a.value}else if(b=="toggle"&&(e=g.event.getTarget(c),a.checked=e.checked,typeof a.onchange=="function"))a.onchange();
return b=="selected"?!1:d}}});g.extend({iframe:{adaptSelf:function(){bg.iframe.adapt(self)},adapt:function(a,b){var c,d,e;if(!(null==a||a.name=="")&&a.parent!=a&&!(a.parent==h.top&&a.parent.document.body.style.overflowY=="hidden"))if(c=a.parent.document.getElementsByName(a.name),!(c.length<1)){c=c[0];if(c!=null&&(c.scrolling=="no"||c.className=="autoadapt"))if(d=a.document.body.scrollHeight+(null==b?0:b),e=0,c.style.height&&(e=parseInt(c.style.height.substring(0,c.style.height.length-2))),d>0&&d>
e)c.style.height=d+"px",bg.logger.debug("adapt frame:"+a.name+" height "+c.style.height);bg.iframe.adapt(a.parent)}}}});g.extend({form:{submit:function(a,b,c,d,e,f){var i,h;typeof a=="string"&&(a=document.getElementById(a));if(d){i=null;if(typeof d=="function")try{i=d(a)}catch(j){alert(j);return}else i=eval(d);if(i==!1)return}if(a.onsubmit){i=null;try{i=a.onsubmit()}catch(k){alert(k);return}if(i==!1)return}(c=null!=c?c:a.target)||(c=bg.findTarget(a));if(b==null)b=a.action;b.indexOf("http://")==0&&
(b=b.substring(b.indexOf("/",7)));if(null==e||e)e=bg.isAjaxTarget(c);i=a.target;d=a.action;a.action=b;if(e){(null==a.id||""==a.id)&&a.setAttribute("id",a.name);e=a.id+"_submit";i=document.getElementById(e);if(null==i)i=document.createElement("input"),i.setAttribute("id",e),i.setAttribute("type","submit"),i.style.display="none",a.appendChild(i);h={id:e,jqueryaction:"button",targets:c,href:"#"};typeof jQuery!="undefined"&&(!f&&jQuery("input:file",a).length==0?g.history.historySubmit(a.id,b,c):jQuery.struts2_jquery.bind(jQuery("#"+
e),h));i.click();jQuery("#"+e).unbind()}else a.target=bg.normalTarget(c),a.submit(),a.target=i;if(a)a.action=d},submitId:function(a,b,c,d,e,f){var g=bg.input.getCheckBoxValues(b);null==c&&(c=!1);""==g?alert(c?"\u8bf7\u9009\u62e9\u4e00\u4e2a\u6216\u591a\u4e2a\u8fdb\u884c\u64cd\u4f5c":"\u8bf7\u9009\u62e9\u4e00\u4e2a\u8fdb\u884c\u64cd\u4f5c"):!c&&g.indexOf(",")>0?alert("\u8bf7\u4ec5\u9009\u62e9\u4e00\u4e2a"):(null!=d?a.action=d:d=a.action,bg.form.addInput(a,c?b+"s":b,g,"hidden"),(null==e||confirm(e))&&
bg.form.submit(a,d,null,null,f))},addInput:function(a,b,c,d){if(a[b]!=null&&typeof a[b]!="string")a[b].value=c;else{null==d&&(d="hidden");var e=document.createElement("input");e.setAttribute("name",b);e.setAttribute("value",c);e.setAttribute("type",d);a.appendChild(e)}},ecodeParams:function(a){if(""==a)return"";var a=a.split("&"),b="",c,d;for(c=0;c<a.length;c++)a[c]!=""&&(d=a[c].indexOf("="),b+="&"+a[c].substr(0,d),-1!=d&&(b+="=",b+=escape(a[c].substr(d+1))));return b},setSearchParams:function(a,
b,c){bg.form.addInput(b,"params","");a=bg.form.getInputParams(a,c,!1);bg.form.addInput(b,"params",a)},addHiddens:function(a,b){bg.assert.notNull(b,"paramSeq for addHiddens must not be null");var c=b.split("&"),d,e,f;for(d=0;d<c.length;d++)c[d]!=""&&(e=c[d].substr(0,c[d].indexOf("=")),f=c[d].substr(c[d].indexOf("=")+1),bg.form.addInput(a,e,f,"hidden"))},addParamsInput:function(a,b){bg.form.addInput(a,"params",b,"hidden")},transferParams:function(a,b,c,d){d==null&&(d=!0);a=bg.form.getInputParams(a,
c,d);bg.form.addHiddens(b,a)},getInputParams:function(a,b,c){var a=a.elements,d="",e;null==c&&(c=!0);for(e=0;e<a.length;e++)if(""!=a[e].name&&"params"!=a[e].name&&!(a[e].value==""&&c==!1))if(null!=b){if(a[e].name.indexOf(b)==0&&a[e].name.indexOf(".")>1&&!((a[e].type=="radio"||a[e].type=="checkbox")&&a[e].checked==!1))d+=a[e].value.indexOf("&")!=-1?"&"+a[e].name+"="+escape(a[e].value):"&"+a[e].name+"="+a[e].value}else(a[e].type=="radio"||a[e].type=="checkbox")&&a[e].checked==!1||(d+=a[e].value.indexOf("&")!=
-1?"&"+a[e].name+"="+escape(a[e].value):"&"+a[e].name+"="+a[e].value);return d},goToPage:function(a,b,c,d){if(typeof a!="object")alert("[goToPage:]form is not well defined.");else{if(null!=b){if(isNaN(b)){alert("\u8f93\u5165\u5206\u9875\u7684\u9875\u7801\u662f:"+b+",\u5b83\u4e0d\u662f\u4e2a\u6574\u6570");return}bg.form.addInput(a,"pageNo",b,"hidden")}else bg.form.addInput(a,"pageNo",1,"hidden");if(null!=c){if(isNaN(c)){alert("\u8f93\u5165\u5206\u9875\u7684\u9875\u957f\u662f:"+c+",\u5b83\u4e0d\u662f\u4e2a\u6574\u6570");
return}bg.form.addInput(a,"pageSize",c,"hidden")}else bg.form.addInput(a,"pageSize","","hidden");null!=d&&d!="null"?bg.form.addInput(a,"orderBy",d,"hidden"):bg.form.addInput(a,"orderBy","","hidden");a.submit()}},goToFirstPage:function(a){bg.form.goToPage(a,1)}}});g.extend({select:{getValues:function(a){for(var b="",c=a.options,a=0;a<c.length;a++)b!=""&&(b+=","),b+=c[a].value;return b},getSelectedValues:function(a){for(var b="",c=a.options,a=0;a<c.length;a++)c[a].selected&&(b!=""&&(b+=","),b+=c[a].value);
return b},hasOption:function(a,b){for(var c=0;c<a.length;c++)if(a.options[c].value==b.value)return!0;return!1},moveSelected:function(a,b){var c,d;for(c=0;c<a.length;c++)a.options[c].selected&&(d=a.options[c],bg.select.hasOption(b,d)||(b.options[b.length]=new Option(d.text,d.value)));bg.select.removeSelected(a);bg.select.clearStatus(a)},clearStatus:function(a){for(var b=0;b<a.options.length;b++)a.options[b].selected=!1},selectAll:function(a){for(var b=0;b<a.options.length;b++)a.options[b].selected=
!0;return a.options.length>0},removeSelected:function(a){var a=a.options,b;for(b=a.length-1;b>=0;b--)a[b].selected&&(a[b]=null)},setSelected:function(a,b){b.indexOf(",")!=0&&(b=","+b);b.lastIndexOf(",")!=b.length-1&&(b+=",");for(var c=0;c<a.options.length;c++)if(b.indexOf(","+a.options[c].value+",")!=-1)a.options[c].selected=!0}}});g.extend({cookie:{get:function(a){var b=document.cookie,c=b.indexOf(a+"=");if(c==-1)return null;c+=a.length+1;a=b.indexOf(";",c);return a==-1?unescape(b.substring(c)):
unescape(b.substring(c,a))},set:function(a,b,c){null==c&&(c="/");var d=new Date;d.setTime(d.getTime()+2592E3);document.cookie=a+"="+b+"; expires="+d.toGMTString()+"; path="+c}}});bg.extend({page:function(a,b){return new f(a,b)}});bg.onReturn=function(a,b){if(!a)a=h.event;a&&a.keyCode&&a.keyCode==13&&b()};g.ready(g.iframe.adaptSelf)}})(window);
(function(h){beangle.history||(jQuery.struts2_jquery.require("/struts/js/plugins/jquery.form"+jQuery.struts2_jquery.minSuffix+".js",function(){h.beangle.history={init:function(){document.location.protocol==="file:"&&alert("The HTML5 History API (and thus History.js) do not work on files, please upload it to a server.");jQuery(document).ready(function(){History.Adapter.bind(h,"statechange",function(){var f=History.getState();if(jQuery.type((f.data||{}).target)!="undefined"&&jQuery.type((f.data||{}).html)!=
"undefined")jQuery(f.data.target).empty(),jQuery(f.data.target).html(f.data.html)})})},back:function(f){return History.back(f)},forward:function(f){return History.forward(f)},historyGo:function(f,g){var a=f.indexOf(" ");if(a>=0)var b=f.slice(a,f.length),f=f.slice(0,a);jQuery.ajax({url:f,type:"GET",dataType:"html",complete:function(a,d,e){e=a.responseText;a.isResolved()&&(a.done(function(a){e=a}),a=b?jQuery("<div>").append(e.replace(rscript,"")).find(b):e,History.pushState({html:a,target:"#"+g},"",
f))}})},historySubmit:function(f,g,a){jQuery.type(f)=="string"&&f.indexOf("#")!=0&&(f="#"+f);jQuery.type(a)=="string"&&a.indexOf("#")!=0&&(a="#"+a);jQuery(f).ajaxForm(function(b,c,d){c==="success"&&d.status==200&&d.readyState==4&&History.pushState({html:b,target:a},"",g);return!1})}}},bg.getContextPath()),beangle.history.init())})(window);
